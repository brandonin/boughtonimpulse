(function(h){h.execute(function(){h.now("reviewsLightbox-js").execute(function(i){i==void 0&&h.when("A","jQuery","ready").execute("reviews-lightbox-load",function(c){ReviewsLightboxGlobalModel=function(){this.applicationResources=void 0;c.$(this).bind("fetchApplicationResourcesSuccess",this,this._fetchApplicationResourcesSuccess);c.$(this).bind("fetchApplicationResourcesError",this,this._fetchApplicationResourcesError);new AjaxRequest("/gp/customer-reviews/aj/private/reviewsGallery/get-application-resources-for-reviews-gallery",
{},this,"fetchApplicationResources",1E4,8)};ReviewsLightboxGlobalModel.prototype.getCustomerInfo=function(){return this.applicationResources.customerInfo};ReviewsLightboxGlobalModel.prototype.getString=function(a){return this.applicationResources.strings[a]};ReviewsLightboxGlobalModel.prototype.getTemplate=function(a){return this.applicationResources.templates[a]};ReviewsLightboxGlobalModel.prototype._fetchApplicationResourcesSuccess=function(a,b){a.data.applicationResources=b;try{window.P.register("reviewsLightbox-globalModel",
function(){})}catch(d){}};ReviewsLightboxGlobalModel.prototype._fetchApplicationResourcesError=function(){new LogMetricsRequest({"ReviewsLightBox:ErrorFetchingTemplates":1})};ReviewsLightboxGlobalModel.prototype.logMetrics=function(a){new AjaxRequestNoReply("/gp/customer-reviews/aj/metrics/log-values",a)};ReviewsLightboxGlobalModel.prototype.replaceStringPlaceholders=function(a,b){for(var d in b)for(var c="{{ "+d+" }}";a.indexOf(c)!==-1;)a=a.replace(c,b[d]);return a};if(!Object.create)Object.create=
function(a){function b(){}if(arguments.length>1)throw Error("Object.create implementation only accepts the first parameter.");b.prototype=a;return new b};ReviewsLightboxModel=function(){this.reviewID=this.asin=void 0;this.imageData=[]};ReviewGallery=function(a,b){this.applicationModel=new ReviewsLightboxModel;this._widgetName=a;this._applicationView=c.$(this._applicationViewTemplate);this._templateStyle=b;this.dataFetcher=new GalleryDataFetcher(this.applicationModel);c.$(this.dataFetcher).bind("dataFetchCallback",
this,this._galleryDataFetchCallback)};ReviewGallery.prototype.render=function(){if(!this.viewRendered)this.viewRendered=!0,this._containerView=c.$("body").find("#"+this._widgetName),this._containerView.append(this._applicationView),this._immersiveViewController=void 0,this._setupImmersiveView(this._templateStyle),this._templateStyle==="DESKTOP"&&this.removeImmersiveViewHideButton()};ReviewGallery.prototype.initializeForReview=function(a){this.applicationModel.reviewID=a;this.dataFetcher.startFetchingData()};
ReviewGallery.prototype._setupImmersiveView=function(a){this._immersiveViewContainerDom=this._containerView.find(".immersiveViewContainer");this._immersiveViewController=new ImmersiveViewController(this._immersiveViewContainerDom,this.applicationModel,a);c.$(this._immersiveViewController).bind("hideImmersiveViewClicked",this,this._hideImmersiveViewClicked)};ReviewGallery.prototype._galleryDataFetchCallback=function(a){a=a.data;a._immersiveViewController&&a._immersiveViewController.refresh();try{if(!a.alreadyRegistedReadyEvent)a.alreadyRegistedReadyEvent=
!0,window.P.register("reviewsLightbox-ready-"+a._widgetName,function(){return{}})}catch(b){new LogMetricsRequest({"ReviewsGallery:AlreadyRegisteredFailure":1})}};ReviewGallery.prototype._hideImmersiveViewClicked=function(a){a=a.data;c.$(a).trigger("hideImmersiveViewClicked");a.templateStyle!=="DESKTOP"&&a.unbindBrowserBack()};ReviewGallery.prototype.removeImmersiveViewHideButton=function(){this._immersiveViewController.removeImmersiveViewHideButton()};ReviewGallery.prototype.showImageAtIndex=function(a){new LogMetricsRequest({"ReviewsLightBox:DP:Tiles:ThumnailClicked":1});
this._immersiveViewController.prepareViewForImageAtIndex(a);this._templateStyle!=="DESKTOP"&&this.bindBrowserBack()};ReviewGallery.prototype.GALLERY_HASH="#GALLERY";ReviewGallery.prototype.bindBrowserBack=function(){if(history&&history.pushState){history.pushState({},"",window.location+this.GALLERY_HASH);var a=this;c.$(window).bind("hashchange",function(){c.$(a).trigger("hideImmersiveViewClicked");a.unbindBrowserBack()})}};ReviewGallery.prototype.unbindBrowserBack=function(){c.$(window).unbind("hashchange");
window.location.hash.indexOf(this.GALLERY_HASH)!=-1&&history&&history.back&&history.back()};ReviewsLightbox=function(a,b){this.applicationModel=new ReviewsLightboxModel;this._containerView=c.$("#"+a);this._applicationView=c.$(this._applicationViewTemplate);this._containerView.append(this._applicationView);this.immersiveViewController=this.thumbnailViewController=void 0;this._lightboxName=a;this.dataFetcher=new GalleryDataFetcher(this.applicationModel);c.$(this.dataFetcher).bind("dataFetchCallback",
this,this._galleryDataFetchCallback);c.$(this.dataFetcher).bind("dataFetchCompleteCallback",this,this._galleryDataFetchCompleteCallback);var d=this;c.$("#"+a).bind("jumpToImageAtIndex",function(a,b){new LogMetricsRequest({"ReviewsLightBox:DP:Widget:ThumnailClicked":1});d._jumpToImageAtIndex(b)});c.$("#"+a).bind("hideImmersiveView",function(){new LogMetricsRequest({"ReviewsLightBox:DP:Widget:SeeAllClicked":1});d._hideImmersiveView()});this._setupGalleryView();this._setupImmersiveView(b);this._lastScrolledPositionSansImmersiveView=
0};ReviewsLightbox.prototype.initializeForAsin=function(a){this.applicationModel.asin=a;this.dataFetcher.startFetchingData()};ReviewsLightbox.prototype.initializeForCustomer=function(a){this.applicationModel.customerID=a;this.dataFetcher.startFetchingData()};ReviewsLightbox.prototype._setupGalleryView=function(){this.imageGalleryDom=this._containerView.find(".compositeThumbnailContentView");this.thumbnailViewController=new CompositeThumbnailViewController(this.imageGalleryDom,this.applicationModel);
c.$(this.thumbnailViewController).bind("thumbnailClicked",this,this._thumbnailClicked)};ReviewsLightbox.prototype._setupImmersiveView=function(a){this.immersiveViewContainerDom=this._containerView.find(".immersiveViewContainer");this.immersiveViewController=new ImmersiveViewController(this.immersiveViewContainerDom,this.applicationModel,a);c.$(this.immersiveViewController).bind("hideImmersiveViewClicked",this,this._hideImmersiveViewClicked)};ReviewsLightbox.prototype._jumpToImageAtIndex=function(a){this.immersiveViewController.prepareViewForImageAtIndex(a);
this._showImmersiveView()};ReviewsLightbox.prototype._thumbnailClicked=function(a,b){var d=a.data;d.immersiveViewController.prepareViewForImageAtIndex(b);d._showImmersiveView()};ReviewsLightbox.prototype._hideImmersiveViewClicked=function(a){a.data._hideImmersiveView()};ReviewsLightbox.prototype._showImmersiveView=function(){this.imageGalleryDom=this._containerView.find(".compositeThumbnailContentView");this.thumbnailViewController.hide();this.immersiveViewController.show()};ReviewsLightbox.prototype._hideImmersiveView=
function(){this.thumbnailViewController.show();this.immersiveViewController.hide()};ReviewsLightbox.prototype._galleryDataFetchCallback=function(a,b){var d=a.data,c=b.images;d._containerView.find(".loadingSection").addClass("hidden");if(b.images&&!(b.images&&b.images.length===0)){d.thumbnailViewController.addThumbnailsForImages(c);try{if(!d.alreadyRegistedReadyEvent)d.alreadyRegistedReadyEvent=!0,window.P.register("reviewsLightbox-ready-"+d._lightboxName,function(){return{}})}catch(f){new LogMetricsRequest({"ReviewsGallery:AlreadyRegisteredFailure":1})}}};
ReviewsLightbox.prototype._galleryDataFetchCompleteCallback=function(a){a=a.data;!a.applicationModel.imageData&&!a.applicationModel.imageData.length&&(a._containerView.find(".noCustomerImagesText").html(window.reviewsLightboxGlobalModel.getString("noCustomerImagesFound")),a._containerView.find(".noCustomerImagesBanner").show())};ReviewsLightboxEmbedded=function(a,b){ReviewsLightbox.call(this,a,b)};ReviewsLightboxEmbedded.prototype=Object.create(ReviewsLightbox.prototype);ReviewsLightboxEmbedded.prototype._showImmersiveView=
function(){this.immersiveViewController.show()};ReviewsLightboxEmbedded.prototype._hideImmersiveView=function(){this.immersiveViewController.hide()};ReviewsLightboxEmbedded.prototype._setupImmersiveView=function(a){this.immersiveViewController=new ImmersiveViewControllerStandAlone(this.applicationModel,a)};CustomerProfileLightbox=function(a,b){ReviewsLightbox.call(this,a,b)};CustomerProfileLightbox.prototype=Object.create(ReviewsLightbox.prototype);CustomerProfileLightbox.prototype.initializeForCustomer=
function(a){this.applicationModel.customerID=a;this.dataFetcher.startFetchingData()};ImmersiveViewController=function(a,b,d){this._applicationModel=b;this._globalModel=window.reviewsLightboxGlobalModel;this._parentViewDom=a;this._view=new ImmersiveView(b,d);this._parentViewDom.append(this._view.viewDom);this._currentElementIndex=0;c.$(this._view).bind("backButtonClicked",this,this._backButtonClicked);c.$(this._view).bind("nextButtonClicked",this,this._nextButtonClicked);c.$(this._view).bind("hideButtonClicked",
this,this._hideClicked);c.$(this._view).bind("moveToImageAtOffset",this,this._moveToImageAtOffset);c.$(this._view).bind("castHelpfulVote",this,this._castHelpfulVote);c.$(this._view).bind("castNotHelpfulVote",this,this._castNotHelpfulVote);c.$(this).bind("castVoteSuccess",this,this._castVoteSuccess);c.$(this).bind("castVoteError",this,this._castVoteError);this.reviewsWithSuccessfulVoteCasts={}};ImmersiveViewController.prototype.refresh=function(){this._updateViewWithReviewAtIndex(this._currentElementIndex);
this._updateNavigationButtons()};ImmersiveViewController.prototype.removeImmersiveViewHideButton=function(){this._view.removeImmersiveViewHideButton()};ImmersiveViewController.prototype.prepareViewForImageAtIndex=function(a){this._currentElementIndex=a;this._updateViewWithReviewAtIndex(a)};ImmersiveViewController.prototype.hide=function(){this._parentViewDom.hide()};ImmersiveViewController.prototype.show=function(){this._parentViewDom.show()};ImmersiveViewController.prototype._moveToImageAtOffset=
function(a,b){var d=a.data;d._currentElementIndex=b;d._updateViewWithReviewAtIndex(b);d._updateNavigationButtons()};ImmersiveViewController.prototype._backButtonClicked=function(a){a=a.data;a._currentElementIndex--;a._currentElementIndex<0?a._currentElementIndex=0:a._updateViewWithReviewAtIndex(a._currentElementIndex);a._updateNavigationButtons()};ImmersiveViewController.prototype._nextButtonClicked=function(a){a=a.data;a._currentElementIndex++;a._currentElementIndex>=a._applicationModel.imageData.length?
a._currentElementIndex=a._applicationModel.imageData.length-1:a._updateViewWithReviewAtIndex(a._currentElementIndex);a._updateNavigationButtons()};ImmersiveViewController.prototype._hideClicked=function(a){c.$(a.data).trigger("hideImmersiveViewClicked")};ImmersiveViewController.prototype._updateNavigationButtons=function(){this._currentElementIndex==0?this._view.hideBackButton():this._view.showBackButton();this._currentElementIndex==this._applicationModel.imageData.length-1?this._view.hideNextButton():
this._view.showNextButton()};ImmersiveViewController.prototype._updateViewWithReviewAtIndex=function(a){var b=this._applicationModel.imageData[a];if(b){if(b.associatedReview){var a=this._fetchAllImagesForReviewAtOffset(a),d=!1,c=this._globalModel.getCustomerInfo();this.reviewsWithSuccessfulVoteCasts[b.associatedReview.reviewId]?d=!0:b.associatedReview.author.customerId===c.customerID&&(d=!0);this._view.updateImageWithAssociatedReview(b.associatedReview,b.largeImage,a,d)}else this._view.updateImageWithAssociatedLegacyImageInfo(b.legacyImageInfo,
b.largeImage);this._updateNavigationButtons()}};ImmersiveViewController.prototype._fetchAllImagesForReviewAtOffset=function(a){for(var b=this._applicationModel.imageData[a],c=this._applicationModel.imageData.length,e=[],f=0;f<c;f++){var g=this._applicationModel.imageData[f];g.associatedReview&&g.associatedReview.reviewId===b.associatedReview.reviewId&&e.push({thumbnail:g.smallImage,shouldHighlight:f===a?!0:!1,index:f})}return e};ImmersiveViewController.prototype._castHelpfulVote=function(a){var a=
a.data,b=this._applicationModel.imageData[a._currentElementIndex];a._globalModel.getCustomerInfo().customerID?(new AjaxRequest(b.votingLinks.helpful,{},a,"castVote",3E3,3),a._view.hideVotingButtons(),a._view.showMessageForVoteInProcess()):window.location.replace(b.votingLinks.helpful)};ImmersiveViewController.prototype._castNotHelpfulVote=function(a){var a=a.data,b=a._applicationModel.imageData[a._currentElementIndex];a._globalModel.getCustomerInfo().customerID?new AjaxRequest(b.votingLinks.notHelful,
{},a,"castVote",3E3,3):window.location.replace(b.votingLinks.helpful)};ImmersiveViewController.prototype._castVoteSuccess=function(){this._view.hideMessageForVoteInProcess();this._view.showMessageForSuccessfulVoteCast();myself.reviewsWithSuccessfulVoteCasts[myself._applicationModel.imageData[myself._currentElementIndex].associatedReview.reviewId]=1};ImmersiveViewController.prototype._castVoteError=function(){this._view.hideMessageForVoteInProcess();this._view.showMessageForErrorDuringVoteCast();this._view.showVotingButtons();
new LogMetricsRequest({"ReviewsLightBox:VoteCastError":1})};ImmersiveViewControllerStandAlone=function(a,b){this._applicationModel=a;this._globalModel=window.reviewsLightboxGlobalModel;this._view=new ImmersiveView(a,b);this._currentElementIndex=0;c.$(this._view).bind("backButtonClicked",this,this._backButtonClicked);c.$(this._view).bind("nextButtonClicked",this,this._nextButtonClicked);c.$(this._view).bind("hideButtonClicked",this,this._hideClicked);c.$(this._view).bind("moveToImageAtOffset",this,
this._moveToImageAtOffset);c.$(this._view).bind("castHelpfulVote",this,this._castHelpfulVote);c.$(this._view).bind("castNotHelpfulVote",this,this._castNotHelpfulVote);c.$(this).bind("castVoteSuccess",this,this._castVoteSuccess);c.$(this).bind("castVoteError",this,this._castVoteError);this.reviewsWithSuccessfulVoteCasts={};this.modal=void 0;var d=this;h.when("a-modal").execute(function(a){d.modal=a.create(c.$("<div></div>"),{content:'<div class="reviewLightboxPopoverContainer"><div class="reviewsLightbox"></div></div>'});
a=d.modal.refresh().getContent().find(".reviewsLightbox");d.modal.hide();a.append(d._view.viewDom)});this._view.removeImmersiveViewHideButton()};ImmersiveViewControllerStandAlone.prototype=Object.create(ImmersiveViewController.prototype);ImmersiveViewControllerStandAlone.prototype.hide=function(){};ImmersiveViewControllerStandAlone.prototype.show=function(){this.modal.show()};ImmersiveView=function(a,b){this._applicationModel=a;this._templateStyle=b;this._globalModel=window.reviewsLightboxGlobalModel;
this.viewDom=void 0;this._renderView();this._addBindingsForButtons();this._isImageInformationPanelExpanded=!1};ImmersiveView.prototype._renderView=function(){var a={hideButtonText:this._templateStyle==="DESKTOP"?this._globalModel.getString("viewImageGallery"):this._globalModel.getString("back")};this.viewDom=c.$(this._globalModel.replaceStringPlaceholders(this._templateStyle==="DESKTOP"?this._immersiveView:this._immersiveViewForMobile,a));this._templateStyle==="MOBILE"&&this.viewDom.bind("touchmove",
function(a){(!a.target||!(a.target.className&&a.target.className==="reviewText"))&&a.preventDefault()});var b=this;this.viewDom.find(".imageElement").load(function(){c.$(this).css({width:"auto",height:"auto"});var a=b.viewDom.find(".imageView");this.width/this.height>=a.width()/a.height()?c.$(this).css({width:"inherit",height:"auto"}):c.$(this).css({width:"auto",height:"inherit"})})};ImmersiveView.prototype.removeImmersiveViewHideButton=function(){this._templateStyle==="MOBILE"?this.viewDom.find(".hideButton").hide():
this.viewDom.find(".immersiveViewMainContent").css({"padding-top":"0px"})};ImmersiveView.prototype._addBindingsForButtons=function(){var a=this.viewDom.find(".hideButton"),b=this.viewDom.find(".backButtonContainer"),d=this.viewDom.find(".nextButtonContainer"),e=this;c.$(b).bind("click",function(){c.$(e).trigger("backButtonClicked")});c.$(d).bind("click",function(){c.$(e).trigger("nextButtonClicked")});c.$(a).bind("click",function(){c.$(e).trigger("hideButtonClicked")});this._templateStyle==="DESKTOP"&&
(a=this.viewDom.find(".imageViewContainer"),c.$(a).bind("mouseleave",this,this._mouseMovedOutOfImmersiveView),c.$(a).bind("mouseenter",this,this._mouseMovedIntoImmersiveView));window.addEventListener&&window.addEventListener("orientationchange",function(){window.scrollTo(0,0)},!1)};ImmersiveView.prototype.updateImageWithAssociatedReview=function(a,b,c,e){this._updateReviewInformation(a,e);this._updateImageViewWithImage(b);this._updateRelatedReviewImages(c)};ImmersiveView.prototype.updateImageWithAssociatedLegacyImageInfo=
function(a,b){this._updateLegacyImageData(a);this._updateImageViewWithImage(b)};ImmersiveView.prototype._updateImageViewWithImage=function(a){this.viewDom.find(".imageElement").attr("src",a)};ImmersiveView.prototype._updateRelatedReviewImages=function(a){var b=this,d=this.viewDom.find(".thumbnails");d.html("");c.$.each(a,function(a,f){var g=c.$(b._globalModel.replaceStringPlaceholders(b._thumbnailTemplate,{url:f.thumbnail}));f.shouldHighlight?(g.addClass("imageHighlight"),g.attr("offset",g.index)):
c.$(g).bind("click",function(){c.$(b).trigger("moveToImageAtOffset",f.index)});d.append(g)})};ImmersiveView.prototype._updateReviewInformation=function(a,b){this._isImageInformationPanelExpanded&&this._collapseImageInformationPanel();var d={rating:a.overallRating,authorName:a.author.displayName,reviewTitle:a.title,reviewText:a.text,date:this._getStringFromEpochTime(a.submissionDateMs),helpfulCount:a.scores.helpfulVotes,notHelpfulCount:parseInt(a.scores.totalVotes)-parseInt(a.scores.helpfulVotes),
productTitle:a.productTitle,customerID:a.author.customerId},d=c.$(this._globalModel.replaceStringPlaceholders(this._globalModel.getTemplate(this._templateStyle==="DESKTOP"?"reviewDisplayComp":"reviewMobileDisplayComp"),d)),e=this.viewDom.find(".imageInformation"),f=d.find(".section-header");c.$(f).bind("click",this,this._imageInformationHeaderClicked);var f=d.find(".helpful_vote_button"),g=d.find(".not_helpful_vote_button");c.$(f).bind("click",this,this._helpfulButtonClicked);c.$(g).bind("click",
this,this._notHelpfulButtonClicked);b&&d.find(".votingStripe").addClass("hidden");this._templateStyle==="MOBILE"&&this.viewDom.find(".imageInformationContainer").css({"margin-top":"-78px"});e.html(d)};ImmersiveView.prototype._updateLegacyImageData=function(a){this._isImageInformationPanelExpanded&&this._collapseImageInformationPanel();var b={authorName:a.authorName,caption:a.caption,date:this._getStringFromEpochTime(a.submissionDateMs),productTitle:a.productTitle,customerID:a.customerID},b=c.$(this._globalModel.replaceStringPlaceholders(this._globalModel.getTemplate(this._templateStyle===
"DESKTOP"?"legacyImageInfoDisplayComp":"legacyImageInfoDisplayCompForMobile"),b)),d=this.viewDom.find(".imageInformation");if(this._templateStyle==="MOBILE")if(a.caption)e=this.viewDom.find(".imageInformationContainer"),a=b.find(".section-header"),c.$(a).bind("click",this,this._imageInformationHeaderClicked),e.css({"margin-top":"-78px"});else{var e=this.viewDom.find(".imageInformationContainer");b.find(".informationPanelExpandButton").addClass("hidden");e.css({"margin-top":"-58px"})}d.html(b)};ImmersiveView.prototype._getStringFromEpochTime=
function(a){try{var b=(new Date(parseInt(a))).toString().split(" "),c=b[1]+" "+b[2]+", "+b[3]}catch(e){return""}return c};ImmersiveView.prototype._imageInformationHeaderClicked=function(a){a=a.data;a._isImageInformationPanelExpanded?a._collapseImageInformationPanel():a._expandImageInformationPanel()};ImmersiveView.prototype._expandImageInformationPanel=function(){this._isImageInformationPanelExpanded=!0;this.viewDom.find(".imageInformationContainer").css({"-webkit-transform":"translate(0px,-300px)",
transition:"1s ease-in-out"});this.viewDom.find(".informationPanelExpandButton").css({transform:"rotate(180deg) scale(0.75)","-webkit-transform":"rotate(180deg) scale(0.75)"});this.viewDom.find(".imageElement").css({"-webkit-transform":"scale(1) translate(0px,-50%)",transition:"1s ease-in-out",opacity:0.75})};ImmersiveView.prototype._collapseImageInformationPanel=function(){this._isImageInformationPanelExpanded=!1;this.viewDom.find(".imageInformationContainer").css({"-webkit-transform":"translate(0px,0px)",
transition:"1s ease-in-out"});this.viewDom.find(".informationPanelExpandButton").css({transform:"rotate(0deg) scale(0.75)","-webkit-transform":"rotate(0deg) scale(0.75)"});this.viewDom.find(".imageElement").css({"-webkit-transform":"scale(1) translate(0px,0px)",transition:"1s ease-in-out",opacity:1})};ImmersiveView.prototype._mouseMovedOutOfImmersiveView=function(a){var b=a.data,a=b.viewDom.find(".back-button"),b=b.viewDom.find(".next-button");a.animate({opacity:0},100);b.animate({opacity:0},100)};
ImmersiveView.prototype._mouseMovedIntoImmersiveView=function(a){var b=a.data,a=b.viewDom.find(".back-button"),b=b.viewDom.find(".next-button");a.animate({opacity:0.25},100);b.animate({opacity:0.25},100)};ImmersiveView.prototype._helpfulButtonClicked=function(a){c.$(a.data).trigger("castHelpfulVote")};ImmersiveView.prototype._notHelpfulButtonClicked=function(a){c.$(a.data).trigger("castNotHelpfulVote")};ImmersiveView.prototype.showBackButton=function(){var a=this.viewDom.find(".back-button");this.viewDom.find(".backButtonContainer").css({cursor:"pointer"});
a.show()};ImmersiveView.prototype.hideBackButton=function(){var a=this.viewDom.find(".back-button");this.viewDom.find(".backButtonContainer").css({cursor:"auto"});a.hide()};ImmersiveView.prototype.showNextButton=function(){var a=this.viewDom.find(".next-button");this.viewDom.find(".nextButtonContainer").css({cursor:"pointer"});a.show()};ImmersiveView.prototype.hideNextButton=function(){var a=this.viewDom.find(".next-button");this.viewDom.find(".nextButtonContainer").css({cursor:"auto"});a.hide()};
ImmersiveView.prototype.showVotingButtons=function(){this.viewDom.find(".votingButtons").show()};ImmersiveView.prototype.hideVotingButtons=function(){this.viewDom.find(".votingButtons").hide()};ImmersiveView.prototype.showMessageForSuccessfulVoteCast=function(){this.viewDom.find(".votingSuccessAlert").show()};ImmersiveView.prototype.showMessageForErrorDuringVoteCast=function(){this.viewDom.find(".votingErrorAlert").show()};ImmersiveView.prototype.showMessageForVoteInProcess=function(){this.viewDom.find(".votingWaitMessage").show()};
ImmersiveView.prototype.hideMessageForVoteInProcess=function(){this.viewDom.find(".votingWaitMessage").hide()};CompositeThumbnailViewController=function(a,b){this._viewContainerDom=a;this._applicationModel=b;this.tiles=[];this._lastSavedScrollPosition=0};CompositeThumbnailViewController.prototype.addThumbnailsForImages=function(a){var b=this;c.$.each(a,function(a,e){var a=b.tiles.length,f=new ThumbnailPreviewTile(a,e.smallImage,64);c.$(f.viewDom).bind("click",function(){c.$(b).trigger("thumbnailClicked",
a)});b.tiles.push(f);b._viewContainerDom.append(f.viewDom);f.makeVisible()})};CompositeThumbnailViewController.prototype.hide=function(){this._viewContainerDom.hide()};CompositeThumbnailViewController.prototype.show=function(){this._viewContainerDom.show()};CompositeThumbnailViewController=function(a,b){this._viewContainerDom=a;this._applicationModel=b;this.tiles=[];this._lastSavedScrollPosition=0};CompositeThumbnailViewController.prototype.addThumbnailsForImages=function(a){var b=this;c.$.each(a,
function(a,e){var a=b.tiles.length,f=new ThumbnailPreviewTile(a,e.smallImage,64);c.$(f.viewDom).bind("click",function(){c.$(b).trigger("thumbnailClicked",a)});b.tiles.push(f);b._viewContainerDom.append(f.viewDom);f.makeVisible()})};CompositeThumbnailViewController.prototype.hide=function(){this._viewContainerDom.hide()};CompositeThumbnailViewController.prototype.show=function(){this._viewContainerDom.show()};ThumbnailPreviewTile=function(a,b){this.index=a;this.url=b;this.viewDom=void 0;this.isVisible=
!1;this._renderTemplate()};ThumbnailPreviewTile.prototype._renderTemplate=function(){this.viewDom=c.$(this._thumbnailTemplate)};ThumbnailPreviewTile.prototype.makeVisible=function(){if(!this.isVisible)this.isVisible=!0,this.viewDom.css({"background-image":'url("'+this.url+'")'})};GalleryDataFetcher=function(a){this.applicationModel=a;this.fetchedAllData=!1;this.nextPageToken=void 0;c.$(this).bind("fetchReviewsDataSuccess",this,this._fetchReviewsDataSuccess);c.$(this).bind("fetchReviewsDataError",
this,this._fetchReviewsDataError)};GalleryDataFetcher.prototype.startFetchingData=function(){var a={};if(this.applicationModel.asin)a.asin=this.applicationModel.asin,new AjaxRequest("/gp/customer-reviews/aj/private/reviewsGallery/get-data-for-reviews-image-gallery-for-asin",a,this,"fetchReviewsData",5E3,3);else if(this.applicationModel.reviewID)a.reviewID=this.applicationModel.reviewID,new AjaxRequest("/gp/customer-reviews/aj/private/reviewsGallery/get-data-for-reviews-image-gallery-for-review",a,
this,"fetchReviewsData",5E3,3);else if(this.applicationModel.customerID)a.customerID=this.applicationModel.customerID,new AjaxRequest("/gp/customer-reviews/aj/private/customerProfile/get-data-for-image-gallery-for-customer-profile",a,this,"fetchReviewsData",5E3,3)};GalleryDataFetcher.prototype._fetchReviewsDataSuccess=function(a,b){for(var d=a.data,e=0;e<b.images.length;e++)d.applicationModel.imageData.push(b.images[e]);c.$(d).trigger("dataFetchCallback",b);if(b.nextPageToken&&JSON)if(e={},d.applicationModel.asin)e.asin=
d.applicationModel.asin,e.nextPageToken=JSON.stringify(b.nextPageToken),new AjaxRequest("/gp/customer-reviews/aj/private/reviewsGallery/get-data-for-reviews-image-gallery-for-asin",e,this,"fetchReviewsData",5E3,3);else{if(d.applicationModel.customerID)e.customerID=d.applicationModel.customerID,e.nextPageToken=JSON.stringify(b.nextPageToken),new AjaxRequest("/gp/customer-reviews/aj/private/customerProfile/get-data-for-image-gallery-for-customer-profile",e,this,"fetchReviewsData",5E3,3)}else c.$(d).trigger("dataFetchCompleteCallback")};
GalleryDataFetcher.prototype._fetchReviewsDataError=function(){};LogMetricsRequest=function(a){new AjaxRequestNoReply("/gp/customer-reviews/aj/metrics/log-values",a)};AjaxRequest=function(a,b,d,e,f,g){f=f?f:4E3;g=g?g:0;b||(b={});b.noCache=(new Date).getTime();c.$.ajax({type:"POST",url:a,data:b,timeout:f,tryCount:0,retryLimit:g,success:function(a){a instanceof Array&&(a={elements:a});c.$(d).trigger(e+"Success",a);c.$(d).trigger(e+"Done",arguments)},error:function(a,b,f){this.tryCount++;this.tryCount<=
this.retryLimit?c.$.ajax(this):(c.$(d).trigger(e+"Error",{errorXHR:a,errorStatus:b,errorThrown:f}),c.$(d).trigger(e+"Done",arguments))}})};AjaxRequestNoReply=function(a,b){a+="?noCache="+(new Date).getTime()+"&";for(var c in b)a+=c+"="+b[c]+"&";if(window.Image)(new Image).src=a};ReviewsLightbox.prototype._applicationViewTemplate=' <div class="noCustomerImagesBanner" style="display:none;color:rgb(94,94,94);"> <b><span class="noCustomerImagesText"></span></b> </div> <div class="large-loadingIcon loadingSection"> </div> <div class="compositeThumbnailContentView" style="width:100%;height;100%;background:white;height:100%;overflow-y:auto;-webkit-overflow-scrolling: touch;"> </div> <div class="immersiveViewContainer" style="width:100%;height:100%;position:absolute;display:none;top:0;z-index:999;"> </div> ';
ReviewGallery.prototype._applicationViewTemplate=' <div class="immersiveViewContainer" style="width:100%;height:100%;position:absolute;top:0;z-index:999;">';ImmersiveView.prototype._immersiveViewForMobile=' <div class="immersiveView" style="width:100%;height:100%;position:relative;background-color: rgb(0, 0, 0);overflow:hidden;"> <div class="hideButton hideButton-mobile"> <span style="text-align:center; margin: auto;font-weight:bold;">{{ hideButtonText }}</span> </div> <div class="imageViewContainer" style="width:100%;float:left;height:100%;position:relative;"> <div class="imageView" style="position:absolute;top:0;left:0;width:100%;height:100%;"> <div style="position:relative;width:100%;height:100%;"> <img class="imageElement" src="" style="position:absolute;top:0;bottom:0;left:0;right:0;margin:auto;max-width:100%;max-height:100%;"> </div> </div> <div class="backButtonContainer"> <div class="back-button back-button-mobile"> </div> </div> <div class="nextButtonContainer"> <div class="next-button next-button-mobile"> </div> </div> </div> <div class="imageInformationContainer" style="width:100%;height:400px;background-color:transparent;float:left;margin-top:-78px;"> <div class="imageInformation imageInformationMobile" style="width:100%;height:100%;position:relative;"> </div> </div>';
ImmersiveView.prototype._immersiveView=' <div class="immersiveView" style="width:100%;height:100%;overflow:hidden;"> <div class="hideButton" style="cursor:pointer;display:inline-block;max-height:30px;overflow:hidden;position:absolute"> <div class="gallery-icon"> </div> <span style="text-align:center; margin:auto; font-weight:bold;">{{ hideButtonText }}</span> </div> <div class="immersiveViewMainContent" style="height:100%;padding-top:30px;"> <div class="imageInformation" style="width:310px;height:100%;background-color:white;float:right;padding-left:18px;overflow-y:scroll;overflow-x:hidden;margin-top:-4px;"> </div> <div class="imageViewContainer" style="height:100%;position:relative;margin-right:310px;background: black;"> <div class="imageView" style="position:absolute;top:0;left:0;width:100%;height:100%;"> <div style="position:relative;width:100%;height:100%;"> <img class="imageElement" src=""> </div> </div> <div class="backButtonContainer"> <div class="back-button"> </div> </div> <div class="nextButtonContainer"> <div class="next-button"> </div> </div> </div> </div>';
ImmersiveView.prototype._thumbnailTemplate=' <div class="thumnail" style="background-image:url({{ url }}); width:48px;height:48px; background-position: center center; background-repeat: no-repeat; overflow: hidden; background-size: cover;cursor: pointer;display: inline-block;margin-left: 5px;"> </div> ';ThumbnailPreviewTile.prototype._thumbnailTemplate=' <div class="thumbnailPreviewTile"> </div> ';if(!window.reviewsLightboxGlobalModel){var i=new ReviewsLightboxGlobalModel;try{h.when("reviewsLightbox-globalModel").register("reviewsLightbox-js",
function(){window.reviewsLightboxGlobalModel=i;return{}})}catch(j){}}})})})})(function(){var h=window.AmazonUIPageJS||P,i=h.attributeErrors;return i?i("ReviewsLightbox"):h}());